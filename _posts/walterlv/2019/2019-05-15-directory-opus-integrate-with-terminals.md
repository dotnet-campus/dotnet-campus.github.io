---
title: "Directory Opus 使用命令编辑器添加 PowerShell / CMD / Bash 等多种终端到自定义菜单"
date: 2019-05-15 17:27:32 +0800
categories: windows
position: starter
---

使用 Directory Opus 替代 Windows 自带的文件资源管理器来管理你计算机上的文件可以极大地提高你的文件处理效率。

本文将教你如何使用 Directory Opus 的命令编辑器功能编写一组菜单，我们将在这组菜单里面集成各种各样的终端。

---

<div id="toc"></div>

## 命令编辑器

如果你是从下面这篇文章阅读过来的，那么你现在应该正好已经打开了一个命令编辑器：

- [在 Directory Opus 中添加自定义的工具栏按钮提升效率](/post/directory-opus-custom-toolbar-buttons)

如果你并没有打开命令编辑器，那么可以再阅读上面这篇文章打开一个。

*`设置` -> `自定义工具栏`，`新建` -> `新建按钮`，`编辑`。*

## 添加三个终端命令

请参考 [Directory Opus 使用命令编辑器集成 TortoiseGit 的各种功能](/post/directory-opus-integrate-with-tortoise-git) 一文中添加自定义按钮的方法，同样地添加另外的三个按钮。这里，我将三个不同终端的添加参数放到了下面，你可以参考添加：

### PowerShell Core

![PowerShell Core](/static/posts/2019-05-15-17-00-43.png)

### Git Bash

![Git Bash](/static/posts/2019-05-15-17-01-00.png)

特别注意，在函数一栏的参数中，我们传入了一个路径参数。那个参数的末尾必须加上 `\.`，否则 Git Bash 是无法启动的。

### CMD

![CMD](/static/posts/2019-05-15-17-01-15.png)

## 添加一个菜单

在添加完上面的三个命令之后，你应该可以在工具栏上看到三个可以启动不同终端的窗口。现在我们需要将它们都集成到一个菜单中。

### 新建一个菜单

在工具栏上空白处右键，`新建` -> `新建菜单`，然后右键，编辑这个菜单：

![新建菜单](/static/posts/2019-05-15-17-03-13.png)

![编辑新建菜单](/static/posts/2019-05-15-17-03-45.png)

然后，我们又可以弹出一个命令编辑器窗口，由于菜单本身不打开命令只会显示子菜单，所以里面非常简单。设置图标和显示的文字即可。

![菜单的命令编辑窗口](/static/posts/2019-05-15-17-05-14.png)

然后，依然保持在工具栏的编辑状态，将我们前面创建的三个按钮依次拖入菜单中即可形成一个菜单：

![拖入到菜单中](/static/posts/2019-05-15-17-12-41.png)

### 新建一个菜单按钮

在工具栏上空白处右键，`新建` -> `新建菜单按钮`，这样的菜单除了显示子项之外，还可以执行命令。然后右键，编辑这个菜单：

![新建菜单按钮](/static/posts/2019-05-15-17-18-42.png)

![编辑新建菜单按钮](/static/posts/2019-05-15-17-22-19.png)

然后，我们又可以弹出一个命令编辑器窗口，如果我们不打算让这个菜单按钮额外具备一些功能，则值设置图标和文字即可。

![菜单按钮的命令编辑窗口](/static/posts/2019-05-15-17-19-30.png)

当然，我更期望在这里将你希望默认打开的终端参数设进去，比较方便一些。

然后，依然保持在工具栏的编辑状态，将我们前面创建的三个按钮依次拖入菜单中即可形成一个菜单：

![拖入到菜单按钮中](/static/posts/2019-05-15-17-25-13.png)

## 后续

关于命令设置的详细细节，可以继续阅读我的另一篇博客：

- [Directory Opus 使用命令编辑器集成 TortoiseGit 的各种功能](/post/directory-opus-integrate-with-tortoise-git)

最后，在自定义完按钮之后，不要忘了关闭最开始弹出来的“自定义工具栏”的对话框。

![“自定义工具栏”对话框](/static/posts/2019-05-15-10-41-23.png)
